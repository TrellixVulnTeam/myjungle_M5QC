{"version":3,"sources":["./src/app/tabs/tabs.page.html","./src/app/tabs/tabs.page.ts","./src/app/tabs/tabs.page.scss","./src/app/tabs/tabs.module.ts","./src/app/tabs/tabs-routing.module.ts","./src/app/services/auth.service.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,kZAAmV,uIAAuI,wqBAAwqB,E;;;;;;;;;;;;;;;;;;;;;;ACCvmC;AACW;IAOxC,QAAQ,SAAR,QAAQ;IAEnB,YAAoB,WAAwB;QAAxB,gBAAW,GAAX,WAAW,CAAa;IAAG,CAAC;IAE9C,MAAM;QACH,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;IAC7B,CAAC;CACJ;;YAdO,kEAAW;;AAON,QAAQ;IALpB,+DAAS,CAAC;QACT,QAAQ,EAAE,UAAU;QACpB,4EAA6B;;KAE9B,CAAC;GACW,QAAQ,CAOpB;AAPoB;;;;;;;;;;;;;ACTrB;AAAe,6GAA8C,+GAA+G,E;;;;;;;;;;;;;;;;;;;;;;ACA/H;AACJ;AACM;AACF;AAEiB;AAEvB;IAW1B,cAAc,SAAd,cAAc;CAAG;AAAjB,cAAc;IAT1B,8DAAQ,CAAC;QACR,OAAO,EAAE;YACP,0DAAW;YACX,4DAAY;YACZ,0DAAW;YACX,0EAAqB;SACtB;QACD,YAAY,EAAE,CAAC,mDAAQ,CAAC;KACzB,CAAC;GACW,cAAc,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;AClBc;AACc;AAChB;AAEvC,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,MAAM;QACZ,SAAS,EAAE,mDAAQ;QACnB,QAAQ,EAAE;YACR;gBACE,IAAI,EAAE,SAAS;gBACf,YAAY,EAAE,GAAG,EAAE,CAAC,wLAAyC,CAAC,IAAI,CAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,iBAAiB,CAAC;aAC9F;YACD;gBACE,IAAI,EAAE,MAAM;gBACZ,YAAY,EAAE,GAAG,EAAE,CAAC,mMAA6B,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC;aAC9E;YACD;gBACE,IAAI,EAAE,MAAM;gBACZ,YAAY,EAAE,GAAG,EAAE,CAAC,mMAA6B,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC;aAC9E;YACD;gBACE,IAAI,EAAE,MAAM;gBACZ,YAAY,EAAE,GAAG,EAAE,CAAC,mMAA6B,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC;aAC9E;YACD;gBACE,IAAI,EAAE,EAAE;gBACR,UAAU,EAAE,eAAe;gBAC3B,SAAS,EAAE,MAAM;aAClB;SACF;KACF;IACD;QACE,IAAI,EAAE,EAAE;QACR,UAAU,EAAE,eAAe;QAC3B,SAAS,EAAE,MAAM;KAClB;CACF,CAAC;IAKW,qBAAqB,SAArB,qBAAqB;CAAG;AAAxB,qBAAqB;IAHjC,8DAAQ,CAAC;QACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;KACzC,CAAC;GACW,qBAAqB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;AC1CO;AACkB;AACV;AAC+B;AACzB;AAChB;AAC2B;AACZ;AAClB;IAUvB,WAAW,SAAX,WAAW;IAUpB,YAAoB,UAAsB,EACtB,MAAc,EACd,OAAgB,EAChB,iBAAoC,EACpC,KAAqB,EACrB,eAAgC,EAChC,IAAgB;QANhB,eAAU,GAAV,UAAU,CAAY;QACtB,WAAM,GAAN,MAAM,CAAQ;QACd,YAAO,GAAP,OAAO,CAAS;QAChB,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,UAAK,GAAL,KAAK,CAAgB;QACrB,oBAAe,GAAf,eAAe,CAAiB;QAChC,SAAI,GAAJ,IAAI,CAAY;QAf5B,gBAAW,GAAG,qEAAW,CAAC,QAAQ,CAAC;QACnC,sBAAiB,GAAG,qEAAW,CAAC,gBAAgB,CAAC;QACjD,cAAS,GAAG,qEAAW,CAAC,eAAe,CAAC;QACxC,qBAAgB,GAAG,KAAK,CAAC;QAGjC,eAAU,GAAG,IAAI,oDAAe,CAAU,KAAK,CAAC,CAAC;QAYjD,YAAO,GAAgB,IAAI,gEAAW,CAAC;YACrC,cAAc,EAAE,kBAAkB;SACnC,CAAC;QAJE,IAAI,CAAC,IAAI,EAAE,CAAC;IAChB,CAAC;IAOK,KAAK,CAAC,QAAgB,EAAE,QAAgB;;YAC1C,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC;YAE3D,MAAM,OAAO,GAAG,IAAI,gEAAW,EAAE,CAAC,GAAG,CAAC,oEAAe,EAAE,EAAE,CAAC,CAAC;YAC3D,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC;gBAC/C,QAAQ,EAAE,IAAI;gBACd,eAAe,EAAE,IAAI;gBACrB,OAAO,EAAE,wBAAwB;gBACjC,OAAO,EAAE,UAAU;gBACnB,EAAE,EAAE,MAAM;aACb,CAAC,CAAC;YAEH,MAAM,MAAM,CAAC,OAAO,EAAE,CAAC,IAAI,EAAE,CAAC;YAE9B,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;gBACxB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,WAAW,EAAE,EAAE,EAAC,QAAQ,EAAE,QAAQ,EAAC,EAAE,EAAC,OAAO,EAAC,CAAC;qBACvE,SAAS,CAAC,CAAO,IAAkB,EAAE,EAAE,CAAC;oBACrC,MAAM,MAAM,CAAC,OAAO,EAAE,CAAC,IAAI,EAAE,CAAC;oBAC9B,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAE;wBACrB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,oBAAM,IAAI,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;4BAC5C,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;4BAC7B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;4BAC5C,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,CAAC,IAAmB,EAAE,EAAE;gCAC5E,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;gCAE/B,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;4BAClD,CAAC,CAAC,CAAC;wBACP,CAAC,CAAC,CAAC;qBAEN;yBAAM;wBACH,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;wBAC9B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;qBAC/C;gBACL,CAAC,GAAE,CAAO,GAAkB,EAAE,EAAE,CAAC;oBAC7B,MAAM,MAAM,CAAC,OAAO,EAAE,CAAC,IAAI,EAAE,CAAC;oBAC9B,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;oBAC9B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;oBAC5C,IAAI,GAAG,YAAY,sEAAiB,EAAE;wBAClC,IAAI,GAAG,CAAC,MAAM,KAAK,GAAG,EAAE;4BACpB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gCAC5C,OAAO,EAAE,0BAA0B;gCACnC,OAAO,EAAE;oCACL;wCACI,IAAI,EAAE,QAAQ;wCACd,IAAI,EAAE,IAAI;qCACb;iCACJ;gCACD,MAAM,EAAE,uBAAuB;6BAClC,CAAC,CAAC;4BAEH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,EAAE,CAAC;yBAChC;6BAAM;4BACH,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gCAC5C,OAAO,EAAE,GAAG,CAAC,UAAU;gCACvB,OAAO,EAAE;oCACL;wCACI,IAAI,EAAE,QAAQ;wCACd,IAAI,EAAE,IAAI;qCACb;iCACJ;gCACD,MAAM,EAAE,uBAAuB;6BAClC,CAAC,CAAC;4BAEH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,EAAE,CAAC;yBAChC;qBACJ;gBACL,CAAC,EAAC,CAAC;aACV;iBAAM;gBACH,MAAM,MAAM,CAAC,OAAO,EAAE,CAAC,IAAI,EAAE,CAAC;gBAC9B,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;gBACtC,OAAO;aACV;QAEL,CAAC;KAAA;IAEO,gBAAgB,CAAC,KAAa;QAClC,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,SAAS,oBAAoB,KAAK,EAAE,CAAC,CAAC,IAAI,CACzE,2DAAI,CAAC,CAAC,CAAC,CACV,CAAC;IACN,CAAC;IAED,MAAM;QACF,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;QAC9B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAC5C,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;QACnC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;QACnC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;IAC1C,CAAC;IAED,IAAI;QACA,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAO,IAAkB,EAAE,EAAE,CAAC;YACxD,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAE;gBACrB,4BAA4B;gBAC5B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,iBAAiB,EAAE,EAAE,EAAC,KAAK,EAAE,IAAI,CAAC,KAAK,EAAC,EAAE;oBACnE,OAAO,EAAE;wBACL,aAAa,EAAE,UAAU,IAAI,CAAC,KAAK,EAAE;qBACxC;iBACJ,CAAC,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,CAAC,GAAsB,EAAE,EAAE;oBAC3C,IAAI,GAAG,CAAC,IAAI,CAAC,MAAM,KAAK,GAAG,EAAE;wBACzB,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,CAAC,IAAmB,EAAE,EAAE;4BAC5E,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;4BAC/B,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;4BAC7B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;wBAChD,CAAC,CAAC;qBACL;yBAAM;wBACH,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;wBAC9B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;qBAC/C;gBACL,CAAC,CAAC,CAAC,KAAK,CAAC,CAAO,GAAsB,EAAE,EAAE,CAAC;oBACvC,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;wBAC5C,OAAO,EAAE,GAAG,CAAC,UAAU;wBACvB,QAAQ,EAAE,IAAI;wBACd,OAAO,EAAE;4BACL;gCACI,IAAI,EAAE,QAAQ;gCACd,IAAI,EAAE,IAAI;6BACb;yBACJ;qBACJ,CAAC,CAAC;oBAEH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,EAAE,CAAC;gBACjC,CAAC,EAAC;aACL;QACL,CAAC,EAAC,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC,CAAC;IAGtD,CAAC;IAED,aAAa;QACT,OAAO,IAAI,CAAC,UAAU,CAAC,YAAY,EAAE,CAAC;IAC1C,CAAC;IAED,mBAAmB;QACf,OAAO,IAAI,CAAC,gBAAgB,CAAC;IACjC,CAAC;CAEJ;;YAhLO,+DAAU;YACM,sDAAM;YACtB,sDAAO;YACU,gEAAiB;YAFlC,8DAAc;YAEd,8DAAe;YAHf,+DAAU;;AAeL,WAAW;IAHvB,gEAAU,CAAC;QACR,UAAU,EAAE,MAAM;KACrB,CAAC;GACW,WAAW,CAiKvB;AAjKuB","file":"tabs-tabs-module.js","sourcesContent":["export default \"<ion-menu slide=\\\"start\\\" menuId=\\\"first\\\" contentId=\\\"main\\\">\\n  <ion-header>\\n    <ion-toolbar color=\\\"primary\\\">\\n      <ion-title>MENU</ion-title>\\n    </ion-toolbar>\\n  </ion-header>\\n  <ion-content>\\n    <ion-list>\\n      <ion-menu-toggle>\\n        <ion-item>\\n            <ion-icon name=\\\"person-circle-outline\\\"></ion-icon> &nbsp; Mi Cuenta\\n      </ion-item>\\n        <ion-item (click)=\\\"logout()\\\">\\n          <ion-icon name=\\\"log-out-outline\\\"></ion-icon> &nbsp; Logout\\n        </ion-item>\\n      </ion-menu-toggle>\\n    </ion-list>\\n  </ion-content>\\n</ion-menu>\\n<ion-router-outlet id=\\\"main\\\"></ion-router-outlet>\\n<ion-tabs>\\n  <ion-tab-bar slot=\\\"bottom\\\">\\n    <ion-tab-button tab=\\\"tab1\\\">\\n      <ion-icon name=\\\"pricetag-outline\\\"></ion-icon>\\n      <ion-label>Tienda</ion-label>\\n    </ion-tab-button>\\n\\n    <ion-tab-button tab=\\\"tab2\\\">\\n      <ion-icon name=\\\"person-outline\\\"></ion-icon>\\n      <ion-label>Mi Cuenta</ion-label>\\n    </ion-tab-button>\\n\\n    <ion-tab-button tab=\\\"tab3\\\">\\n      <ion-icon name=\\\"cart\\\"></ion-icon>\\n      <ion-label>Carrito</ion-label>\\n    </ion-tab-button>\\n  </ion-tab-bar>\\n\\n</ion-tabs>\\n\";","\nimport { Component } from '@angular/core';\nimport {AuthService} from \"../services/auth.service\";\n\n@Component({\n  selector: 'app-tabs',\n  templateUrl: 'tabs.page.html',\n  styleUrls: ['tabs.page.scss']\n})\nexport class TabsPage {\n\n  constructor(private authService: AuthService) {}\n\n    logout() {\n       this.authService.logout();\n    }\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ0YWJzLnBhZ2Uuc2NzcyJ9 */\";","import { IonicModule } from '@ionic/angular';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { TabsPageRoutingModule } from './tabs-routing.module';\n\nimport { TabsPage } from './tabs.page';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    TabsPageRoutingModule\n  ],\n  declarations: [TabsPage]\n})\nexport class TabsPageModule {}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { TabsPage } from './tabs.page';\n\nconst routes: Routes = [\n  {\n    path: 'tabs',\n    component: TabsPage,\n    children: [\n      {\n        path: 'welcome',\n        loadChildren: () => import('../pages/welcome/welcome.module').then( m => m.WelcomePageModule)\n      },\n      {\n        path: 'tab1',\n        loadChildren: () => import('../tab1/tab1.module').then(m => m.Tab1PageModule)\n      },\n      {\n        path: 'tab2',\n        loadChildren: () => import('../tab2/tab2.module').then(m => m.Tab2PageModule)\n      },\n      {\n        path: 'tab3',\n        loadChildren: () => import('../tab3/tab3.module').then(m => m.Tab3PageModule)\n      },\n      {\n        path: '',\n        redirectTo: '/tabs/welcome',\n        pathMatch: 'full'\n      }\n    ]\n  },\n  {\n    path: '',\n    redirectTo: '/tabs/welcome',\n    pathMatch: 'full'\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n})\nexport class TabsPageRoutingModule {}\n","import {Injectable} from '@angular/core';\r\nimport {environment} from \"../../environments/environment\";\r\nimport {BehaviorSubject, Observable} from \"rxjs\";\r\nimport {HttpClient, HttpErrorResponse, HttpHeaders} from \"@angular/common/http\";\r\nimport {ActivatedRoute, Router} from \"@angular/router\";\r\nimport {Storage} from \"@ionic/storage\";\r\nimport {AlertController, LoadingController} from \"@ionic/angular\";\r\nimport {SkipInterceptor} from \"./backend.interceptor\";\r\nimport {take} from \"rxjs/operators\";\r\nimport {CustomerModel} from \"../models/customerModel\";\r\nimport { User } from \"../models/user\";\r\nimport { map } from \"rxjs/operators\";\r\n\r\n\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class AuthService {\r\n    private WP_AUTH_URL = environment.auth_url;\r\n    private WP_JWT_VERIFY_URL = environment.token_verify_url;\r\n    private serverUrl = environment.backend_api_url;\r\n    private currentAuthState = false;\r\n    returnUrl: string;\r\n\r\n    authState$ = new BehaviorSubject<boolean>(false);\r\n\r\n\r\n    constructor(private httpClient: HttpClient,\r\n                private router: Router,\r\n                private storage: Storage,\r\n                private loadingController: LoadingController,\r\n                private route: ActivatedRoute,\r\n                private alertController: AlertController,\r\n                private http: HttpClient) {\r\n        this.init();\r\n    }\r\n    headers: HttpHeaders = new HttpHeaders({\r\n      \"Content-Type\": \"application/json\"\r\n    })\r\n\r\n\r\n\r\n    async login(username: string, password: string) {\r\n        this.returnUrl = this.route.snapshot.queryParams.returnUrl;\r\n\r\n        const headers = new HttpHeaders().set(SkipInterceptor, '');\r\n        const loader = await this.loadingController.create({\r\n            animated: true,\r\n            backdropDismiss: true,\r\n            message: \"Authenticating Account\",\r\n            spinner: \"crescent\",\r\n            id: \"auth\"\r\n        });\r\n\r\n        await loader.present().then();\r\n\r\n        if (!this.currentAuthState) {\r\n            this.httpClient.post(`${this.WP_AUTH_URL}`, {username, password}, {headers})\r\n                .subscribe(async (data: AuthResponse) => {\r\n                    await loader.dismiss().then();\r\n                    if (data.token !== null) {\r\n                        this.storage.set('data', {...data}).then(resp => {\r\n                            this.currentAuthState = true;\r\n                            this.authState$.next(this.currentAuthState);\r\n                            this.fetchUserDetails(data.user_email).toPromise().then((user: CustomerModel) => {\r\n                                this.storage.set('user', user);\r\n\r\n                                this.router.navigate([this.returnUrl]).then();\r\n                            });\r\n                        });\r\n\r\n                    } else {\r\n                        this.currentAuthState = false;\r\n                        this.authState$.next(this.currentAuthState);\r\n                    }\r\n                }, async (err: ErrorResponse) => {\r\n                    await loader.dismiss().then();\r\n                    this.currentAuthState = false;\r\n                    this.authState$.next(this.currentAuthState);\r\n                    if (err instanceof HttpErrorResponse) {\r\n                        if (err.status === 403) {\r\n                            const alert = await this.alertController.create({\r\n                                message: 'Bad Username Or Password',\r\n                                buttons: [\r\n                                    {\r\n                                        role: 'cancel',\r\n                                        text: 'Ok'\r\n                                    }\r\n                                ],\r\n                                header: 'Authentication Failed'\r\n                            });\r\n\r\n                            await alert.present().then();\r\n                        } else {\r\n                            const alert = await this.alertController.create({\r\n                                message: err.statusText,\r\n                                buttons: [\r\n                                    {\r\n                                        role: 'cancel',\r\n                                        text: 'Ok'\r\n                                    }\r\n                                ],\r\n                                header: 'Authentication Failed'\r\n                            });\r\n\r\n                            await alert.present().then();\r\n                        }\r\n                    }\r\n                });\r\n        } else {\r\n            await loader.dismiss().then();\r\n            this.router.navigateByUrl('/').then();\r\n            return;\r\n        }\r\n\r\n    }\r\n\r\n    private fetchUserDetails(email: string) {\r\n        return this.httpClient.get(`${this.serverUrl}/customers?email=${email}`).pipe(\r\n            take(1)\r\n        );\r\n    }\r\n\r\n    logout() {\r\n        this.currentAuthState = false;\r\n        this.authState$.next(this.currentAuthState);\r\n        this.storage.remove('user').then();\r\n        this.storage.remove('data').then();\r\n        this.router.navigateByUrl('/').then();\r\n    }\r\n\r\n    init() {\r\n        this.storage.get('data').then(async (data: AuthResponse) => {\r\n            if (data.token !== null) {\r\n                // Verify the token validity\r\n                this.httpClient.post(`${this.WP_JWT_VERIFY_URL}`, {token: data.token}, {\r\n                    headers: {\r\n                        Authorization: `Bearer ${data.token}`\r\n                    }\r\n                }).toPromise().then((res: jwtVerifyResponse) => {\r\n                    if (res.data.status === 200) {\r\n                        this.fetchUserDetails(data.user_email).toPromise().then((user: CustomerModel) => {\r\n                            this.storage.set('user', user);\r\n                            this.currentAuthState = true;\r\n                            this.authState$.next(this.currentAuthState);\r\n                        })\r\n                    } else {\r\n                        this.currentAuthState = false;\r\n                        this.authState$.next(this.currentAuthState);\r\n                    }\r\n                }).catch(async (err: HttpErrorResponse) => {\r\n                    const alert = await this.alertController.create({\r\n                        message: err.statusText,\r\n                        animated: true,\r\n                        buttons: [\r\n                            {\r\n                                role: 'cancel',\r\n                                text: 'Ok'\r\n                            }\r\n                        ]\r\n                    });\r\n\r\n                    await alert.present().then();\r\n                })\r\n            }\r\n        }).catch(err => console.log('Token not present'));\r\n\r\n\r\n    }\r\n\r\n    getAuthState$(): Observable<boolean> {\r\n        return this.authState$.asObservable();\r\n    }\r\n\r\n    getCurrentAuthState(): boolean {\r\n        return this.currentAuthState;\r\n    }\r\n\r\n}\r\n\r\n\r\nexport interface AuthResponse {\r\n    token: string;\r\n    user_email: string;\r\n    user_nicename: string;\r\n    user_display_name: string;\r\n}\r\n\r\n// tslint:disable-next-line:class-name\r\nexport interface jwtVerifyResponse {\r\n    code: string;\r\n    data: {\r\n        status: number\r\n    };\r\n}\r\n\r\n\r\ninterface ErrorResponse {\r\n    status: number;\r\n    statusText: string;\r\n}\r\n\r\n"],"sourceRoot":"webpack:///"}